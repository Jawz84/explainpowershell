Describe "explainpowershell.helpcollector.tools.tests" {
    It "Returns expected output" {
        try {
            $null = [explainpowershell.helpcollector.tools.DeCompress]
        }
        catch {
            $typeDef = Get-Content $PSScriptRoot\..\explainpowershell.helpcollector\tools\DeCompress.cs -Raw
            Add-Type -TypeDefinition $typeDef
        }

        $json = @'
        {
            "Aliases": "",
            "CommandName": "New-VM",
            "DefaultParameterSet": "DefaultParameterSet",
            "Description": "This cmdlet creates a new virtual machine with the provided parameters. The network adapter and the Small Computer System Interface (SCSI) adapter of the new virtual machine are created of the recommended type for the operating system (OS) that is specified by the GuestId parameter. If  the OSCustomizationSpec parameter is used,  the virtual machine is customized according to the specification. You must specify values for at least one of the ResourcePool, VMHost, and VApp parameters.",
            "DocumentationLink": "http://developer.vmware.com/docs/powercli/latest/vmware.vimautomation.core/commands/new-vm",
            "InputTypes": "",
            "ModuleName": "VMware.VimAutomation.Core",
            "ModuleVersion": "12.5.0.19093566",
            "ModuleProjectUri": "",
            "Parameters": "[{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies advanced options for creating virtual machines. Accepts only SdrsVMDiskAntiAffinityRule and SdrsVMAntiAffinityRule objects.\\r\\nThe SdrsVMDiskAntiAffinityRule defines a Storage DRS intra-VM anti-affinity rule (vm disk anti-affinity rule). It is only applicable when creating a virtual machine or hard disk on a datastore cluster. You can create an instance of the object by invoking its constructor. There are two constructors - \\\"public SdrsVMDiskAntiAffinityRule(param string[] diskIdentifier)\\\" and \\\"public SdrsVMDiskAntiAffinityRule(param HardDisk[] disk)\\\". For the first constructor, \\\"diskIdentifier\\\" can be either the disk key or the index of the disk in the disk array. The specified disks (and the disk to which the rule is applied) are placed in an anti-affinity rule on a DatastoreCluster. Only one such rule is supported per a virtual machine. You can pass the instance to the AdvancedOption parameter of the New-VM or New-HardDisk cmdlets.\\r\\nThe SdrsVMAntiAffinityRule defines a Storage DRS inter-VM anti-affinity rule. It is only applicable when creating a virtual machine on a DatastoreCluster. You can create an instance of the object by invoking its constructor. The constructor has one parameter - an array of virtual machines - \\\"public SdrsVMAntiAffinityRule(param VirtualMachine[] vm)\\\". Then you can pass the instance to the AdvancedOption parameter of the New-VM cmdlet. ?he new virtual machine and the virtual machines specified in the constructor are placed in an inter-VM anti-affinity rule on a DatastoreCluster.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"AdvancedOption\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"CloneVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"Template\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"AdvancedOption[]\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the full OS name of the new virtual machine. Use this parameter if the GuestID parameter is set to otherGuest or otherGuest64.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"AlternateGuestName\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"String\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the time interval in milliseconds between a virtual machine power on or restart and the beginning of the boot sequence.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"BootDelayMillisecond\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"CloneVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"Template\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"RegisterVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"Int64\"},{\"Aliases\":\"none\",\"DefaultValue\":\"False\",\"Description\":\"Indicates that you want to add a CD drive to the new virtual machine.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"CD\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":true,\"TypeName\":\"SwitchParameter\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the content library template from which you want to deploy the virtual machine.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"ContentLibraryItem\",\"ParameterSets\":{\"FromContentLibraryItem\":{\"IsMandatory\":true,\"Position\":1,\"ValueFromPipeline\":true,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"True (ByValue)\",\"Position\":\"2\",\"Required\":\"true\",\"SwitchParameter\":false,\"TypeName\":\"ContentLibraryItem\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the number of virtual CPU cores per socket.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"CoresPerSocket\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"FromContentLibraryItem\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"Int32\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the datastore where you want to place the new virtual machine. If a DatastoreCluster is passed to the Datastore parameter, the virtual machine is placed in the DatastoreCluster in an automated SDRS mode and with enabled intra-VM affinity rule (unless another rule is specified). You can specify a SDRS rule when creating the virtual machine in a DatastoreCluster by passing either a SdrsVMDiskAntiAffinityRule object or a SdrsVMAntiAffinityRule object to the AdvancedOption parameter. These two rules are mutually exclusive.\",\"Globbing\":\"true\",\"IsDynamic\":false,\"Name\":\"Datastore\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"Template\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"CloneVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"FromContentLibraryItem\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"StorageResource\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the size in gigabytes (GB) of the disks that you want to create and add to the new virtual machine.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"DiskGB\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"FromContentLibraryItem\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"Decimal[]\"},{\"Aliases\":\"none\",\"DefaultValue\":\"4096\",\"Description\":\"This parameter is obsolete. Use DiskGB instead. Specifies the size in megabytes (MB) of the disks that you want to create and add to the new virtual machine.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"DiskMB\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"FromContentLibraryItem\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"Int64[]\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies paths to virtual disks that you want to add to the new virtual machine.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"DiskPath\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"String[]\"},{\"Aliases\":\"StorageFormat\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the storage format of the disks of the virtual machine. This parameter accepts Thin, Thick, and EagerZeroedThick values.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"DiskStorageFormat\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"Template\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"CloneVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"FromContentLibraryItem\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"VirtualDiskStorageFormat\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies a DRS (Distributed Resource Scheduler) automation level. The valid values are FullyAutomated, Manual, PartiallyAutomated, AsSpecifiedByCluster, and Disabled. Passing values to this parameter through a pipeline is deprecated and will be disabled in a future release. Specifying this parameter is only supported when the virtual machine is inside a cluster. Otherwise, an error appears.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"DrsAutomationLevel\",\"ParameterSets\":{\"__AllParameterSets\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"DrsAutomationLevel\"},{\"Aliases\":\"none\",\"DefaultValue\":\"False\",\"Description\":\"Indicates that you want to add a floppy drive to the new virtual machine.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"Floppy\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":true,\"TypeName\":\"SwitchParameter\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the guest operating system of the new virtual machine. The valid values for specific ESX versions are listed in the description of the VirtualMachineGuestOsIdentifier enumeration type in the vSphere API Reference available at http://www.vmware.com/support/developer/vc-sdk/. Depending on the hardware configuration of the host, some of the guest operating systems might be inapplicable.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"GuestId\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"String\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Indicates whether the virtual machine should be powered off if a host determines that it is isolated from the rest of the compute resource. The available values are AsSpecifiedByCluster, PowerOff, and DoNothing. Passing values to this parameter through a pipeline is deprecated and will be disabled in a future release. Specifying this parameter is only supported when the virtual machine is inside a cluster. Otherwise, an error appears.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"HAIsolationResponse\",\"ParameterSets\":{\"__AllParameterSets\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"HAIsolationResponse\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the version of the new virtual machine. By default, the new virtual machine is created with the latest available version.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"HardwareVersion\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"String\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the HA restart priority of the new virtual machine. The valid values are Disabled, Lowest, Low, Medium, High, Highest, and ClusterRestartPriority. VMware High Availability (HA) is a feature that detects failed virtual machines and automatically restarts them on alternative ESX hosts. Passing values to this parameter through a pipeline is deprecated and will be disabled in a future release. Specifying this parameter is only supported when the virtual machine is inside a cluster. Otherwise, an error appears.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"HARestartPriority\",\"ParameterSets\":{\"__AllParameterSets\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"HARestartPriority\"},{\"Aliases\":\"none\",\"DefaultValue\":\"False\",\"Description\":\"Indicates that you want to create a linked clone. When you set the LinkedClone parameter, the ReferenceSnapshot parameter becomes mandatory.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"LinkedClone\",\"ParameterSets\":{\"CloneVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":true,\"TypeName\":\"SwitchParameter\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the folder where you want to place the new virtual machine.\",\"Globbing\":\"true\",\"IsDynamic\":false,\"Name\":\"Location\",\"ParameterSets\":{\"__AllParameterSets\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"Folder\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the memory size in gigabytes (GB) of the new virtual machine.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"MemoryGB\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"FromContentLibraryItem\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"Decimal\"},{\"Aliases\":\"none\",\"DefaultValue\":\"256\",\"Description\":\"This parameter is obsolete. Use MemoryGB instead. Specifies the memory size in megabytes (MB) of the new virtual machine.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"MemoryMB\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"FromContentLibraryItem\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"Int64\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the encryption behavior when migrating the virtual machine.  Valid options are: - Disabled: Do not use encrypted vSphere vMotion.\\r\\n- Opportunistic: Use encrypted vSphere vMotion if source and destination hosts support it. Only ESXi versions 6.5 and later use encrypted vSphere vMotion.\\r\\n- Required: Allow only encrypted vSphere vMotion. If the source or destination host does not support encrypted vSphere vMotion, migration with vSphere vMotion is not allowed.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"MigrationEncryption\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"VMMigrationEncryptionMode\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies a name for the new virtual machine. If you want to register or clone an existing virtual machine, this parameter is not mandatory.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"Name\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":true,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"Template\":{\"IsMandatory\":true,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"RegisterVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"CloneVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"FromContentLibraryItem\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"true\",\"SwitchParameter\":false,\"TypeName\":\"String\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the networks to which you want to connect the new virtual machine. Specifying a distributed port group name is obsolete. Use the Portgroup parameter instead.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"NetworkName\",\"ParameterSets\":{\"Template\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"FromContentLibraryItem\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"String[]\"},{\"Aliases\":\"Description\",\"DefaultValue\":\"None\",\"Description\":\"Provides a description of the new virtual machine. The alias of this parameter is Description.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"Notes\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"CloneVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"Template\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"RegisterVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"FromContentLibraryItem\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"String\"},{\"Aliases\":\"none\",\"DefaultValue\":\"1\",\"Description\":\"Specifies the number of the virtual CPUs of the new virtual machine.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"NumCpu\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"FromContentLibraryItem\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"Int32\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies a customization specification that is applied to the new virtual machine.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"OSCustomizationSpec\",\"ParameterSets\":{\"Template\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"CloneVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"FromContentLibraryItem\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"OSCustomizationSpec\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies values for a set of user-configurable OVF properties.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"OvfConfiguration\",\"ParameterSets\":{\"FromContentLibraryItem\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"Hashtable\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies standard or distributed port groups to which you want to connect the virtual machine. For each specified port group, a new network adapter is created.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"Portgroup\",\"ParameterSets\":{\"Template\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"FromContentLibraryItem\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"VirtualPortGroupBase[]\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies a source snapshot for the linked clone that you want to create. When you set the LinkedClone parameter, the ReferenceSnapshot parameter becomes mandatory.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"ReferenceSnapshot\",\"ParameterSets\":{\"CloneVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"Snapshot\"},{\"Aliases\":\"Pool\",\"DefaultValue\":\"None\",\"Description\":\"Specifies where you want to place the new virtual machine. The parameter accepts VMHost, Cluster, ResourcePool, and VApp objects. If no value is specified, the virtual machine is added to the resource pool of its host.\",\"Globbing\":\"true\",\"IsDynamic\":false,\"Name\":\"ResourcePool\",\"ParameterSets\":{\"__AllParameterSets\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":true,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"True (ByValue)\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"VIContainer\"},{\"Aliases\":\"none\",\"DefaultValue\":\"False\",\"Description\":\"Indicates that the command returns immediately without waiting for the task to complete. In this mode, the output of the cmdlet is a Task object. For more information about the RunAsync parameter, run \\\"help About_RunAsync\\\" in the VMware PowerCLI console.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"RunAsync\",\"ParameterSets\":{\"__AllParameterSets\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":true,\"TypeName\":\"SwitchParameter\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the vCenter Server systems on which you want to run the cmdlet. If no value is provided or $null value is passed to this parameter, the command runs on the default servers. For more information about default servers, see the description of the Connect-VIServer cmdlet.\",\"Globbing\":\"true\",\"IsDynamic\":false,\"Name\":\"Server\",\"ParameterSets\":{\"__AllParameterSets\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"VIServer[]\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies whether SEV (Secure Encrypted Virtualization) is enabled or not. It allows the CPU to encrypt the memory and the state of the virtual machine. It is applicable for AMD CPUs only.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"SEVEnabled\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"CloneVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"Template\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"RegisterVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"Boolean\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the virtual machine template that you want to use for the creation of the new virtual machine. Passing values to this parameter through a pipeline is deprecated and will be disabled in a future release.\",\"Globbing\":\"true\",\"IsDynamic\":false,\"Name\":\"Template\",\"ParameterSets\":{\"Template\":{\"IsMandatory\":true,\"Position\":1,\"ValueFromPipeline\":true,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"True (ByValue)\",\"Position\":\"2\",\"Required\":\"true\",\"SwitchParameter\":false,\"TypeName\":\"Template\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"This parameter is deprecated. Use the ResourcePool parameter instead. Specifies the vApp where you want to create the new virtual machine.\",\"Globbing\":\"true\",\"IsDynamic\":false,\"Name\":\"VApp\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":true,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"Template\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":true,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"RegisterVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":true,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"CloneVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":true,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"True (ByValue)\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"VApp\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"This parameter is deprecated. Use the HardwareVersion parameter instead. Specifies the version of the new virtual machine. The valid values are v4, v7, v8, v9, v10, v11, v12, v13, and v14. By default, the new virtual machine is created with the latest available version.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"Version\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"VMVersion\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies a virtual machine that you want to clone.\",\"Globbing\":\"true\",\"IsDynamic\":false,\"Name\":\"VM\",\"ParameterSets\":{\"CloneVm\":{\"IsMandatory\":true,\"Position\":-2147483648,\"ValueFromPipeline\":true,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"True (ByValue)\",\"Position\":\"named\",\"Required\":\"true\",\"SwitchParameter\":false,\"TypeName\":\"VirtualMachine[]\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies a path to the virtual machine that you want to register.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"VMFilePath\",\"ParameterSets\":{\"RegisterVm\":{\"IsMandatory\":true,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"true\",\"SwitchParameter\":false,\"TypeName\":\"String\"},{\"Aliases\":\"Host\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the host on which you want to create the new virtual machine.\",\"Globbing\":\"true\",\"IsDynamic\":false,\"Name\":\"VMHost\",\"ParameterSets\":{\"__AllParameterSets\":{\"IsMandatory\":false,\"Position\":0,\"ValueFromPipeline\":true,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"True (ByValue)\",\"Position\":\"1\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"VMHost\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the swapfile placement policy. The following values are valid:\\r\\nInHostDataStore - stores the swapfile in the datastore specified by the VMSwapfileDatastoreID property of the virtual machine host. If the VMSwapfileDatastoreID property is not set or indicates a datastore with insufficient free space, the swapfile is stored in the same directory as the virtual machine. This setting might degrade the vMotion performance.\\r\\nWithVM - stores the swapfile in the same directory as the virtual machine.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"VMSwapfilePolicy\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"VMSwapfilePolicy\"},{\"Aliases\":\"cf\",\"DefaultValue\":\"$true\",\"Description\":\"If the value is $true, indicates that the cmdlet asks for confirmation before running. If the value is $false, the cmdlet runs without asking for user confirmation.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"Confirm\",\"ParameterSets\":{\"__AllParameterSets\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":true,\"TypeName\":\"SwitchParameter\"},{\"Aliases\":\"wi\",\"DefaultValue\":\"False\",\"Description\":\"Indicates that the cmdlet is run only to display the changes that would be made and actually no objects are modified.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"WhatIf\",\"ParameterSets\":{\"__AllParameterSets\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":true,\"TypeName\":\"SwitchParameter\"},{\"Aliases\":\"none\",\"DefaultValue\":\"False\",\"Description\":\"Specifies whether to apply the StoragePolicy or Encryption to the hard disks in the new virtual machine.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"SkipHardDisks\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"CloneVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"Template\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":true,\"TypeName\":\"SwitchParameter\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the StoragePolicy that you want to attach to the new virtual machine during creation. If the StoragePolicy is an encryption policy, the new virtual machine is encrypted.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"StoragePolicy\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"CloneVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"Template\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"FromContentLibraryItem\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"StoragePolicy\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the ReplicationGroup where you want to place the new virtual machine. It is applicable with the storage policy provided in the StoragePolicy parameter.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"ReplicationGroup\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"CloneVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"Template\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"ReplicationGroup\"},{\"Aliases\":\"none\",\"DefaultValue\":\"VmHomeAndHardDisks\",\"Description\":\"Specifies the target of the StoragePolicy in the virtual machine or in the VM parameter.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"StoragePolicyTarget\",\"ParameterSets\":{\"CloneVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"Template\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"StoragePolicyTargetType\"},{\"Aliases\":\"KmsCluster\",\"DefaultValue\":\"None\",\"Description\":\"Specifies the key provider that you want to use for the encryption key while creating the new virtual machine. If StoragePolicy is not specified, the default encryption storage policy \\\"VM Encryption Policy\\\" is used.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"KeyProvider\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"CloneVm\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null},\"Template\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"KeyProvider\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies if virtual processors can be added to the virtual machine while it is running.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"CpuHotAddEnabled\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"Boolean\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies if virtual processors can be removed from the virtual machine while it is running.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"CpuHotRemoveEnabled\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"Boolean\"},{\"Aliases\":\"none\",\"DefaultValue\":\"None\",\"Description\":\"Specifies if memory can be added to the virtual machine while it is running.\",\"Globbing\":\"false\",\"IsDynamic\":false,\"Name\":\"MemoryHotAddEnabled\",\"ParameterSets\":{\"DefaultParameterSet\":{\"IsMandatory\":false,\"Position\":-2147483648,\"ValueFromPipeline\":false,\"ValueFromPipelineByPropertyName\":false,\"ValueFromRemainingArguments\":false,\"HelpMessage\":null,\"HelpMessageBaseName\":null,\"HelpMessageResourceId\":null}},\"PipelineInput\":\"False\",\"Position\":\"named\",\"Required\":\"false\",\"SwitchParameter\":false,\"TypeName\":\"Boolean\"}]",
            "ParameterSetNames": "CloneVm, DefaultParameterSet, FromContentLibraryItem, RegisterVm, Template",
            "RelatedLinks": "http://developer.vmware.com/docs/powercli/latest/vmware.vimautomation.core/commands/new-vm",
            "ReturnValues": "The newly created VirtualMachine object",
            "Synopsis": "This cmdlet creates a new virtual machine.",
            "Syntax": "New-VM [[-VMHost] <VMHost>] [-AdvancedOption <AdvancedOption[]>] [-AlternateGuestName <String>] [-BootDelayMillisecond <Int64>] [-CD] [-CoresPerSocket <Int32>] [-Datastore <StorageResource>] [-DiskGB <Decimal[]>] [-DiskMB <Int64[]>] [-DiskPath <String[]>] [-DiskStorageFormat <VirtualDiskStorageFormat>] [-DrsAutomationLevel <DrsAutomationLevel>] [-Floppy] [-GuestId <String>] [-HAIsolationResponse <HAIsolationResponse>] [-HardwareVersion <String>] [-HARestartPriority <HARestartPriority>] [-Location <Folder>] [-MemoryGB <Decimal>] [-MemoryMB <Int64>] [-MigrationEncryption {Opportunistic | Disabled | Required}] -Name <String> [-NetworkName <String[]>] [-Notes <String>] [-NumCpu <Int32>] [-Portgroup <VirtualPortGroupBase[]>] [-ResourcePool <VIContainer>] [-RunAsync] [-Server <VIServer[]>] [-SEVEnabled <Boolean>] [-VApp <VApp>] [-Version <VMVersion>] [-VMSwapfilePolicy <VMSwapfilePolicy>] [-Confirm] [-WhatIf] [-SkipHardDisks] [-StoragePolicy <StoragePolicy>] [-ReplicationGroup <ReplicationGroup>] [-KeyProvider <KeyProvider>] [-CpuHotAddEnabled <Boolean>] [-CpuHotRemoveEnabled <Boolean>] [-MemoryHotAddEnabled <Boolean>] [<CommonParameters>]\r\n\r\nNew-VM [[-VMHost] <VMHost>] [-AdvancedOption <AdvancedOption[]>] [-BootDelayMillisecond <Int64>] [-Datastore <StorageResource>] [-DiskStorageFormat <VirtualDiskStorageFormat>] [-DrsAutomationLevel <DrsAutomationLevel>] [-HAIsolationResponse <HAIsolationResponse>] [-HARestartPriority <HARestartPriority>] [-LinkedClone] [-Location <Folder>] [-Name <String>] [-Notes <String>] [-OSCustomizationSpec <OSCustomizationSpec>] [-ReferenceSnapshot <Snapshot>] [-ResourcePool <VIContainer>] [-RunAsync] [-Server <VIServer[]>] [-SEVEnabled <Boolean>] [-VApp <VApp>] -VM <VirtualMachine[]> [-Confirm] [-WhatIf] [-SkipHardDisks] [-StoragePolicy <StoragePolicy>] [-ReplicationGroup <ReplicationGroup>] [-StoragePolicyTarget <StoragePolicyTargetType>] [-KeyProvider <KeyProvider>] [<CommonParameters>]\r\n\r\nNew-VM [[-VMHost] <VMHost>] [-Template] <Template> [-AdvancedOption <AdvancedOption[]>] [-BootDelayMillisecond <Int64>] [-Datastore <StorageResource>] [-DiskStorageFormat <VirtualDiskStorageFormat>] [-DrsAutomationLevel <DrsAutomationLevel>] [-HAIsolationResponse <HAIsolationResponse>] [-HARestartPriority <HARestartPriority>] [-Location <Folder>] -Name <String> [-NetworkName <String[]>] [-Notes <String>] [-OSCustomizationSpec <OSCustomizationSpec>] [-Portgroup <VirtualPortGroupBase[]>] [-ResourcePool <VIContainer>] [-RunAsync] [-Server <VIServer[]>] [-SEVEnabled <Boolean>] [-VApp <VApp>] [-Confirm] [-WhatIf] [-SkipHardDisks] [-StoragePolicy <StoragePolicy>] [-ReplicationGroup <ReplicationGroup>] [-StoragePolicyTarget <StoragePolicyTargetType>] [-KeyProvider <KeyProvider>] [<CommonParameters>]\r\n\r\nNew-VM [[-VMHost] <VMHost>] [-BootDelayMillisecond <Int64>] [-DrsAutomationLevel <DrsAutomationLevel>] [-HAIsolationResponse <HAIsolationResponse>] [-HARestartPriority <HARestartPriority>] [-Location <Folder>] [-Name <String>] [-Notes <String>] [-ResourcePool <VIContainer>] [-RunAsync] [-Server <VIServer[]>] [-SEVEnabled <Boolean>] [-VApp <VApp>] -VMFilePath <String> [-Confirm] [-WhatIf] [<CommonParameters>]\r\n\r\nNew-VM [[-VMHost] <VMHost>] [-ContentLibraryItem] <ContentLibraryItem> [-CoresPerSocket <Int32>] [-Datastore <StorageResource>] [-DiskGB <Decimal[]>] [-DiskMB <Int64[]>] [-DiskStorageFormat <VirtualDiskStorageFormat>] [-DrsAutomationLevel <DrsAutomationLevel>] [-HAIsolationResponse <HAIsolationResponse>] [-HARestartPriority <HARestartPriority>] [-Location <Folder>] [-MemoryGB <Decimal>] [-MemoryMB <Int64>] [-Name <String>] [-NetworkName <String[]>] [-Notes <String>] [-NumCpu <Int32>] [-OSCustomizationSpec <OSCustomizationSpec>] [-OvfConfiguration <Hashtable>] [-Portgroup <VirtualPortGroupBase[]>] [-ResourcePool <VIContainer>] [-RunAsync] [-Server <VIServer[]>] [-Confirm] [-WhatIf] [-StoragePolicy <StoragePolicy>] [<CommonParameters>]"
        }
'@

        $paramsOriginal = $json | ConvertFrom-Json | Select-Object -ExpandProperty parameters
        $compressedParams = [explainpowershell.helpcollector.tools.DeCompress]::Compress($paramsOriginal)
        $decompressedParams = [explainpowershell.helpcollector.tools.DeCompress]::Decompress($compressedParams)

        [System.Text.ASCIIEncoding]::Unicode.GetByteCount($paramsOriginal) / 1kb | Should -BeGreaterThan 64
        [System.Text.ASCIIEncoding]::Unicode.GetByteCount($compressedParams) / 1kb | Should -BeLessThan 64
        $decompressedParams | Should -BeExactly $paramsOriginal
    }
}
